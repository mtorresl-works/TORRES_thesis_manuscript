
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  1. Package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \usepackage{ctex} % chinese
\usepackage{subfiles} % import independent document
\usepackage{geometry}
\usepackage{fancyhdr} % header and footer
\usepackage{graphicx} % insert fig
\usepackage{pdfpages} % insert pdf
\usepackage{multicol} % muti-column
\usepackage{multirow} 
\usepackage{setspace} % line spacing
\usepackage{makeidx} % index
\usepackage{tikz} % plot env
\usepackage{indentfirst} % \chapter、\section indentation for the first line
\usepackage{caption,subcaption}  % title and subtitle
\usepackage{amsmath,amsthm,amssymb,amsfonts,mathrsfs} % math
\usepackage{siunitx}  % SI unit
\usepackage{pifont} % special symbol
\usepackage{hyperref} % link
\usepackage{cleveref}
\usepackage{booktabs} % three line table
\usepackage{tabularx} % three line table
\usepackage{longtable}
\usepackage[ruled,linesnumbered]{algorithm2e}  % algorithm
\usepackage[shortlabels]{enumitem} % list env
\usepackage{xcolor} % font color
\usepackage{graphbox} % figure position
\usepackage{minted} % code style
% \usepackage{listings} % code style (not recommended)
\usepackage{environ}
\usepackage{mdframed}

\usepackage{natbib}
\bibliographystyle{unsrt} %  abbrv

\usepackage{pdfpages} % include pages from external pdf file

% \usepackage{titlesec}    % Remove the text 'Chapter' from each chapter.
% \titleformat{\chapter}{\normalfont\huge\bf}{\thechapter}{20pt}{\huge\bf}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  2. Page Setting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% margin
\geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}

% footer and header
\pagestyle{fancy}
\fancyfoot[C]{\thepage}
\fancyhead[L]{\nouppercase{\leftmark}}
\fancyhead[R]{\nouppercase{\rightmark}}
\renewcommand{\headrulewidth}{1.5pt}

% spacing
\linespread{1.2}  % line spacing || 1.2 times font size
\setlength{\parindent}{2em} % indentation for the first line
\setlength{\parskip}{1ex} % spacing for each paragraph
\setlength{\headsep}{1.5\baselineskip}

% link color
\hypersetup{
    colorlinks = true,
    citecolor = blue, % References
    linkcolor = black,
    filecolor = magenta,
    urlcolor = {blue!40!black},
}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  3. Plot Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usetikzlibrary{trees,positioning,fit,calc}
\tikzset{block/.style = {draw, fill=blue!20, rectangle,
                         minimum height=3em, minimum width=4em},
        input/.style = {coordinate},
        output/.style = {coordinate}
}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  4. Question Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{problem}[2][Problem]
    {\begin{mdframed}[backgroundcolor=gray!10] \textbf{#1 #2} \\}
    {\end{mdframed}}

\newenvironment{solution}{\textbf{Solution}}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     5. Code Env || use 'minted' and 'pygments'
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usemintedstyle{vs}  % minted code style refer to https://pygments.org/styles/

\newminted{python}{
    mathescape,
    linenos=true, 
    breaklines=true,
    bgcolor=gray!10,
    numbersep=5pt,
    frame=lines,
    framesep=2mm,
}

\newmintedfile{python}{
    mathescape,
    linenos=true, 
    breaklines=true,
    bgcolor=gray!10,
    numbersep=5pt,
    frame=lines,
    framesep=2mm,
}

\newminted{julia}{
    mathescape,
    linenos=true, 
    breaklines=true,
    bgcolor=gray!10,
    numbersep=5pt,
    frame=lines,
    framesep=2mm,
}

\newmintedfile{julia}{
    mathescape,
    linenos=true, 
    breaklines=true,
    bgcolor=gray!10,
    numbersep=5pt,
    frame=lines,
    framesep=2mm,
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% listing package is not recommended now, showing below
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \lstset{
%     basicstyle          =   {\small\ttfamily},
%     keywordstyle        =   \bfseries,
%     commentstyle        =   \rmfamily\itshape,
%     stringstyle         =   \ttfamily,
%     flexiblecolumns,
%     numbers             =   none,
%     showspaces          =   false,
%     numberstyle         =   \small\ttfamily,
%     showstringspaces    =   false,
%     captionpos          =   t,
%     frame               =   tb,
% }

% \lstdefinestyle{Python}{
%     language        =   Python,
%     keywordstyle    =   \color{blue},
%     keywordstyle    =   [2] \color{teal},
%     stringstyle     =   \color{magenta},
%     commentstyle    =   \color{gray}\ttfamily,
%     breaklines      =   true,
%     columns         =   fixed,
%     basewidth       =   0.5em,
% }

% \lstdefinelanguage{Julia}%
%   {morekeywords={abstract,break,case,catch,const,continue,do,else,elseif,%
%       end,export,false,for,function,immutable,import,importall,if,in,%
%       macro,module,otherwise,quote,return,switch,true,try,type,typealias,%
%       using,while},%
%    sensitive=true,%
%    alsoother={$},%
%    morecomment=[l]\#,%
%    morecomment=[n]{\#=}{=\#},%
%    morestring=[s]{"}{"},%
%    morestring=[m]{'}{'},%
% }[keywords,comments,strings]%

% \lstdefinestyle{Julia}{
%     language        =   Julia,
%     keywordstyle    =   \color{blue},
%     keywordstyle    =   [2] \color{teal},
%     stringstyle     =   \color{magenta},
%     commentstyle    =   \color{gray}\ttfamily,
%     breaklines      =   true,
%     columns         =   fixed,
%     basewidth       =   0.5em,
% }





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  6. Fig Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\graphicspath{figures/}
\captionsetup[figure]{
  labelfont={bf},
  labelformat={default},
  name={Figure.},
  labelsep=colon
}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                 7. Footnote Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \interfootnotelinepenalty=10000 % 禁止脚注显示在第二页
% % redefine footnote as circled number: ①②③④⑤⑥⑦⑧⑨
% \renewcommand{\thefootnote}{\ding{\numexpr171+\value{footnote}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                 8. Dedication Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{dedication}
  {\clearpage           % we want a new page
   \thispagestyle{empty}% no header and footer
   \vspace*{\stretch{1}}% some space at the top
   \itshape             % the text is in italics
   \raggedleft          % flush to the right margin
  }
  {\par % end the paragraph
   \vspace{\stretch{3}} % space at bottom is three times that at the top
   \clearpage           % finish off the page
  }

  
%%%%%%%%%%%%%%%%%%%%
%% PRIVATE MACROS %%
%%%%%%%%%%%%%%%%%%%%

\newcommand{\figwidth}{0.55 \columnwidth}
\newcommand{\eq}[1]{Eq.~(\ref{#1})}
\newcommand{\eqs}[1]{Eqs.~(\ref{#1})}
\newcommand{\fig}[1]{Fig.~\ref{#1}}
\newcommand{\avg}[1]{ {\langle #1 \rangle} }
\newcommand{\sect}[1]{Section~\ref{#1}}

\definecolor{amber}{rgb}{1.0, 0.75, 0.0}

\newcommand{\eeq}{ \end{equation} }
\newcommand{\beq}{ \begin{equation} }

\newcommand{\eea}{ \end{align} }
\newcommand{\bea}{ \begin{align} }


\newcommand{\oma}{{\bf \hat{u}}}
\newcommand{\omb}{{\bf \hat{u}^{\prime}} }


\newcommand{\bs}{ {\bf s }}

 \newcommand{\sgn}{\operatorname{sgn}}


\newcommand{\bhua}{ {\bf \hat{u}}_{1} }
\newcommand{\bhub}{ {\bf \hat{u}}_{2} }
\newcommand{\bhui}{ {\bf \hat{u}}_{i} }
\newcommand{\bhu}{ {\bf \hat{u}} }
\newcommand{\bhe}{ {\bf \hat{e}} }
\newcommand{\az}{  \psi}
\newcommand{\aza}{  \psi_{1} }
\newcommand{\azb}{  \psi_{2} }
\newcommand{\ta}{  t_{1} }
\newcommand{\tb}{  t_{2} }
\newcommand{\qa}{  k_{1} }
\newcommand{\qb}{  k_{2} }
\newcommand{\phant}{ \vphantom{\frac{a}{b}}  }
\newcommand{\kpa}{k_{\parallel}}
\newcommand{\pp}{{\mathcal P}_{2}}

\DeclareMathOperator{\sech}{sech}


\newcommand{\lang} {\left \langle \left \langle }
\newcommand{\rang} {\right \rangle \right \rangle}
\newcommand{\bu}{ {\bf u} }
\newcommand{\bra}{ {\bYf r}_1 }
\newcommand{\brb}{ {\bf r}_2 }
\newcommand{\bhr}{ {\bf \hat{r}} }
\newcommand{\bfr}{ {\bf r} }
\newcommand{\bk}{ {\bf k} }
\newcommand{\bz}{ {\bf \hat{z}} }
\newcommand{\bes}{ {\bf s} }
\newcommand{\bx}{ {\bf \hat{x}} }
\newcommand{\by}{ {\bf \hat{y}} }
\newcommand{\bv}{ {\bf \hat{v}} }
\newcommand{\bw}{ {\bf \hat{w}} }
\newcommand{\bn}{ {\bf \hat{n}} }
\newcommand{\kbt}{k_{B}T}
\newcommand{\ellp}{\ell^{\prime}}
\newcommand{\ellpp}{\ell^{\prime \prime}}
\newcommand{\ellb}{\bar{\ell}}
\newcommand{\ellbp}{\bar{\ell}^{\prime}}
\newcommand{\nab}{  {\bf \nabla }}
\newcommand{\red}[1]{ { \color{red} #1 } }
\newcommand{\blue}[1]{ { \color{blue} #1 } }
\newcommand{\amber}[1]{ { \color{amber} #1 } }

\newcommand{\talpha}{\tilde{\alpha}}