
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  1. Package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \usepackage{ctex} % chinese
\usepackage{geometry}
\usepackage{fancyhdr} % header and footer
\usepackage{graphicx} % insert fig

\usepackage[
%ragged
%raggedright
%raggedleft
]{sidecap}
\sidecaptionvpos{figure}{t} % caption on the side
\usepackage{pdfpages} % insert pdf
\usepackage{multicol} % muti-column
\usepackage{multirow} 
\usepackage{setspace} % line spacing
\usepackage{makeidx} % index
\usepackage{tikz} % plot env
\usepackage{indentfirst} % \chapter、\section indentation for the first line
\usepackage{caption,subcaption}  % title and subtitle
\usepackage{amsmath,amsthm,amssymb,amsfonts,mathrsfs} % math
\usepackage{siunitx}  % SI unit
\usepackage{pifont} % special symbol
\usepackage{hyperref} % link
\usepackage{cleveref}
\usepackage{booktabs} % three line table
\usepackage{tabularx} % three line table
\usepackage{longtable}
\usepackage[ruled,linesnumbered]{algorithm2e}  % algorithm
\usepackage[shortlabels]{enumitem} % list env
\usepackage{xcolor} % font color
\usepackage{graphbox} % figure position
%\usepackage{minted} % code style
% \usepackage{listings} % code style (not recommended)
\usepackage{environ}
\usepackage{mdframed}
\usepackage{bm}

%\usepackage{natbib}
%\bibliographystyle{unsrt} %  abbrv


\usepackage[autostyle]{csquotes}
\usepackage[style=numeric,citestyle=numeric,sortcites=none, sorting=none, autopunct=true,autolang=hyphen,hyperref=true,abbreviate=true,backref=false, backend=biber,defernumbers=true, doi=false, url=false, giveninits=true]{biblatex}
\addbibresource{bib/pub.bib}
\addbibresource{bib/refs.bib}
\addbibresource{bib/rik.bib}
\AtEveryBibitem{\clearfield{title}} %remove title from references

\usepackage[toc,page,title,titletoc]{appendix} % appendix

\usepackage{bookmark}
\usepackage{afterpage} % blank pages


%\usepackage{titlesec}    % Remove the text 'Chapter' from each chapter.
% \titleformat{\chapter}{\normalfont\huge\bf}{\thechapter}{20pt}{\huge\bf}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  2. Page Setting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% margin
\geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}

% footer and header
\pagestyle{fancy}
\fancyfoot[C]{\thepage}
\fancyhead[L]{\nouppercase{\leftmark}}
\fancyhead[R]{\nouppercase{\rightmark}}
\renewcommand{\headrulewidth}{1.5pt}

% spacing
\linespread{1.2}  % line spacing || 1.2 times font size
\setlength{\parindent}{2em} % indentation for the first line
\setlength{\parskip}{1ex} % spacing for each paragraph
\setlength{\headsep}{1.5\baselineskip}

% link color
\hypersetup{
    colorlinks = true,
    citecolor = blue, % References
    linkcolor = black,
    filecolor = magenta,
    urlcolor = {blue!40!black},
}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  3. Plot Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usetikzlibrary{trees,positioning,fit,calc}
\tikzset{block/.style = {draw, fill=blue!20, rectangle,
                         minimum height=3em, minimum width=4em},
        input/.style = {coordinate},
        output/.style = {coordinate}
}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  4. Question Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{problem}[2][Problem]
    {\begin{mdframed}[backgroundcolor=gray!10] \textbf{#1 #2} \\}
    {\end{mdframed}}

\newenvironment{solution}{\textbf{Solution}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  4. Abstract Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newenvironment{abstract}
%    {\begin{quote}{\small \centering
%    \textbf{Abstract
%
%    }\small\itshape } \\}
%    {\end{quote}}
\newenvironment{abstract}{%
    \small
    \begin{center}%
        {\bfseries Abstract}%
    \end{center}%
    \quotation\itshape}
    {\endquotation}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                  6. Fig Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\graphicspath{figures/}
\captionsetup[figure]{
  labelfont={bf},
  labelformat={default},
  name={Figure},
  labelsep=colon
}

% Centering the figures
\makeatletter
\g@addto@macro\@floatboxreset\centering
\makeatother






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                 7. Footnote Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \interfootnotelinepenalty=10000 % 禁止脚注显示在第二页
% % redefine footnote as circled number: ①②③④⑤⑥⑦⑧⑨
% \renewcommand{\thefootnote}{\ding{\numexpr171+\value{footnote}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                 8. Dedication Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newenvironment{dedication}
  {\clearpage           % we want a new page
   \thispagestyle{empty}% no header and footer
   \vspace*{\stretch{1}}% some space at the top
   \itshape             % the text is in italics
   \raggedleft          % flush to the right margin
  }
  {\par % end the paragraph
   \vspace{\stretch{3}} % space at bottom is three times that at the top
   \clearpage           % finish off the page
  }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                 8. Appendix Env
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\AtBeginEnvironment{subappendices}{%
\chapter*{Appendices}
%\addcontentsline{toc}{section}{Appendices}
\pdfbookmark[section]{Appendices}{toc}
\counterwithin{figure}{section}
\counterwithin{table}{section}

\hypersetup{bookmarksdepth=-1}
}

\AtEndEnvironment{subappendices}{%
\hypersetup{bookmarksdepth}
}

  
%%%%%%%%%%%%%%%%%%%%
%% PRIVATE MACROS %%
%%%%%%%%%%%%%%%%%%%%

\newcommand{\figwidth}{0.55 \columnwidth}
\newcommand{\eq}[1]{Eq.~(\ref{#1})}
\newcommand{\eqs}[1]{Eqs.~(\ref{#1})}
\newcommand{\fig}[1]{Fig.~\ref{#1}}
\newcommand{\avg}[1]{ {\langle #1 \rangle} }
\newcommand{\sect}[1]{Section~\ref{#1}}


\newcommand{\oma}{{\bf \hat{u}}}
\newcommand{\omb}{{\bf \hat{u}^{\prime}} }


\newcommand{\bs}{ {\bf s }}

\DeclareMathOperator{\arcsec}{arcsec}
\DeclareMathOperator{\sech}{sech}


 \newcommand{\sgn}{\operatorname{sgn}}


% lowers subscript when necessary

\def\ds{\rule{0pt}{1.5ex}}



\newcommand{\bhua}{ {\bf \hat{u}}_{1} }
\newcommand{\bhub}{ {\bf \hat{u}}_{2} }
\newcommand{\bhui}{ {\bf \hat{u}}_{i} }
\newcommand{\bhu}{ {\bf \hat{u}} }
\newcommand{\bhup}{\bf \hat{u}^{\prime}}
\newcommand{\bhe}{ {\bf \hat{e}} }
\newcommand{\az}{  \psi}
\newcommand{\aza}{  \psi_{1} }
\newcommand{\azb}{  \psi_{2} }
\newcommand{\ta}{  t_{1} }
\newcommand{\tb}{  t_{2} }
\newcommand{\qa}{  k_{1} }
\newcommand{\qb}{  k_{2} }
\newcommand{\phant}{ \vphantom{\frac{a}{b}}  }
\newcommand{\kpa}{k_{\parallel}}
\newcommand{\pp}{{\mathcal P}_{2}}


\newcommand{\lang} {\left \langle \left \langle }
\newcommand{\rang} {\right \rangle \right \rangle}
\newcommand{\bu}{ {\bf u} }
\newcommand{\bra}{ {\bf r}_1 }
\newcommand{\brb}{ {\bf r}_2 }
\newcommand{\bhr}{ {\bf \hat{r}} }
\newcommand{\bfr}{ {\bf r} }
\newcommand{\bfrp}{ {\bf r ^{\prime}}}

\newcommand{\bfrpe}{ {\bf r}_{\perp} }
\newcommand{\bfrpeb}{ {\bf r_{\perp} ^{\prime}} }
\newcommand{\bk}{ {\bf k} }
\newcommand{\bz}{ {\bf \hat{z}} }
\newcommand{\bes}{ {\bf s} }
\newcommand{\bn}{ {\bf \hat{n}} }
\newcommand{\bx}{ {\bf \hat{x}} }
\newcommand{\by}{ {\bf \hat{y}} }
\newcommand{\bv}{ {\bf \hat{v}} }
\newcommand{\bw}{ {\bf \hat{w}} }
\newcommand{\kbt}{k_{\rm B}T}
\newcommand{\ellp}{\ell^{\prime}}
\newcommand{\ellpp}{\ell^{\prime \prime}}
\newcommand{\ellb}{\bar{\ell}}
\newcommand{\ellbp}{\bar{\ell}^{\prime}}
\newcommand{\nab}{  {\bf \nabla }}
\newcommand{\Nab}{  {\bf \partial }}
\newcommand{\red}[1]{ { \color{red} #1 } }
\newcommand{\blue}[1]{ { \color{blue} #1 } }
\newcommand{\amber}[1]{ { \color{amber} #1 } }

\newcommand{\eeq}{ \end{equation} }
\newcommand{\beq}{ \begin{equation} }

\newcommand{\eea}{ \end{align} }
\newcommand{\bea}{ \begin{align} }

\newcommand{\talpha}{\tilde{\alpha}}



\newcommand{\brr}{ {\bf R} }
\newcommand{\bdr}{ {\bf  r} }

\newcommand{\bal}{ {\bm \hat{\alpha}} }
\newcommand{\bars}{ {\bf \hat{R}} }
\newcommand{\bwa}{   \hat{\omega}_{1} }
\newcommand{\bwb}{   \hat{\omega}_{2} }
\newcommand{\bwaz}{   \omega_{1z} }
\newcommand{\bwbz}{   \omega_{2z} }
\newcommand{\bwar}{   \omega_{1x} }
\newcommand{\bwbr}{   \omega_{2x} }
\newcommand{\bwaa}{   \omega_{1\alpha} }
\newcommand{\bwba}{   \omega_{2\alpha} }
\newcommand{\bwi}{   \hat{\omega}_{i} }
\newcommand{\bwj}{   \hat{\omega}_{j} }

\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}


